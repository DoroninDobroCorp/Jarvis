# üé® –§–µ–π–∫–æ–≤—ã–µ —Ç–µ–Ω–∏ + –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ = –ö—Ä–∞—Å–æ—Ç–∞ + –°–∫–æ—Ä–æ—Å—Ç—å

## –ü—Ä–æ–±–ª–µ–º–∞

Canvas `shadowBlur` ‚Äî **–æ—á–µ–Ω—å –¥–æ—Ä–æ–≥–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è**:
- –¢—Ä–µ–±—É–µ—Ç blur —Ñ–∏–ª—å—Ç—Ä –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–∏–∫—Å–µ–ª—è
- –ù–∞ 100 —É–∑–ª–∞—Ö = 100 blur –æ–ø–µ—Ä–∞—Ü–∏–π –∫–∞–∂–¥—ã–π –∫–∞–¥—Ä
- FPS –ø–∞–¥–∞–µ—Ç —Å 60 –¥–æ 15-30

## –†–µ—à–µ–Ω–∏–µ: "–§–µ–π–∫–æ–≤—ã–µ —Ç–µ–Ω–∏"

–í–º–µ—Å—Ç–æ `shadowBlur` —Ä–∏—Å—É–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç —Å–æ —Å–º–µ—â–µ–Ω–∏–µ–º:

### –ë—ã–ª–æ (–º–µ–¥–ª–µ–Ω–Ω–æ):
```typescript
<Rect
  fill="#E8D8A6"
  shadowColor="#00000099"
  shadowBlur={8}          // ‚Üê –¥–æ—Ä–æ–≥–æ!
  shadowOffset={{ x: 2, y: 3 }}
/>
```

### –°—Ç–∞–ª–æ (–±—ã—Å—Ç—Ä–æ):
```typescript
{/* "–¢–µ–Ω—å" - –ø—Ä–æ—Å—Ç–æ –ø–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π Rect */}
<Rect
  x={3}
  y={4}
  fill="#00000020"        // ‚Üê –¥–µ—à–µ–≤–æ!
  cornerRadius={8}
  perfectDrawEnabled={false}
/>

{/* –û—Å–Ω–æ–≤–Ω–æ–π —ç–ª–µ–º–µ–Ω—Ç */}
<Rect
  fill="#E8D8A6"
  cornerRadius={8}
  shadowBlur={0}          // ‚Üê –Ω–µ—Ç blur!
/>
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç

- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –í 10x –±—ã—Å—Ç—Ä–µ–µ —á–µ–º shadowBlur
- **–í–∏–∑—É–∞–ª**: –í—ã–≥–ª—è–¥–∏—Ç –ø–æ—á—Ç–∏ —Ç–∞–∫ –∂–µ (–∂–µ—Å—Ç–∫–∞—è —Ç–µ–Ω—å –≤–º–µ—Å—Ç–æ —Ä–∞–∑–º—ã—Ç–æ–π)
- **FPS**: –û—Å—Ç–∞—ë—Ç—Å—è 55-60 –¥–∞–∂–µ —Å–æ 100+ —É–∑–ª–∞–º–∏

## –í–∏–∑—É–∞–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ

### shadowBlur (—Å—Ç–∞—Ä—ã–π):
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –£–∑–µ–ª   ‚îÇ  ‚Üê —Ä–∞–∑–º—ã—Ç–∞—è –º—è–≥–∫–∞—è —Ç–µ–Ω—å
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    ‚ï≤‚ï≤‚ï≤
```

### –§–µ–π–∫–æ–≤–∞—è —Ç–µ–Ω—å (–Ω–æ–≤—ã–π):
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –£–∑–µ–ª   ‚îÇ  ‚Üê –∂–µ—Å—Ç–∫–∞—è –Ω–æ –±—ã—Å—Ç—Ä–∞—è —Ç–µ–Ω—å
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
  ‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì
```

–†–∞–∑–Ω–∏—Ü–∞ –ø–æ—á—Ç–∏ –Ω–µ–∑–∞–º–µ—Ç–Ω–∞ –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ, –Ω–æ FPS –≤ 10 —Ä–∞–∑ –ª—É—á—à–µ!

## –ë–æ–Ω—É—Å: Konva Caching

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –∫—ç—à–∏—Ä—É–µ–º —Å—Ç–∞—Ç–∏—á–Ω—ã–µ —É–∑–ª—ã:

```typescript
useEffect(() => {
  // –ü—Ä–µ–≤—Ä–∞—â–∞–µ–º —É–∑–µ–ª –≤ –∫–∞—Ä—Ç–∏–Ω–∫—É –∫–æ–≥–¥–∞ –æ–Ω –Ω–µ –¥–≤–∏–≥–∞–µ—Ç—Å—è
  if (groupRef.current && !isDragging && !selected) {
    groupRef.current.cache();
  }
}, [isDragging, selected]);
```

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:
1. **–°—Ç–∞—Ç–∏—á–Ω—ã–π —É–∑–µ–ª** ‚Üí Konva —Å–æ–∑–¥–∞—ë—Ç canvas snapshot (–∫–∞—Ä—Ç–∏–Ω–∫—É)
2. **–ü—Ä–∏ —Ä–µ–Ω–¥–µ—Ä–µ** ‚Üí –ø—Ä–æ—Å—Ç–æ –∫–æ–ø–∏—Ä—É–µ—Ç –∫–∞—Ä—Ç–∏–Ω–∫—É (–æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ)
3. **–ü—Ä–∏ drag** ‚Üí –æ—Ç–∫–ª—é—á–∞–µ—Ç –∫—ç—à, –¥–≤–∏–≥–∞–µ—Ç –∫–∞–∫ –æ–±—ã—á–Ω–æ
4. **–ü–æ—Å–ª–µ drag** ‚Üí —Å–Ω–æ–≤–∞ –∫—ç—à–∏—Ä—É–µ—Ç

### –†–µ–∑—É–ª—å—Ç–∞—Ç:
- –†–µ–Ω–¥–µ—Ä 100 —Å—Ç–∞—Ç–∏—á–Ω—ã—Ö —É–∑–ª–æ–≤: **5-10ms** –≤–º–µ—Å—Ç–æ 40-60ms
- –ü—Ä–∏ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–∏: –∫–∞–∫ –æ–±—ã—á–Ω–æ (–∫—ç—à –æ—Ç–∫–ª—é—á–µ–Ω)

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç–∏ —Ç–µ–Ω–∏

–ú–æ–∂–Ω–æ —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞—Ç—å –Ω–∞—Å–∫–æ–ª—å–∫–æ –≤–∏–¥–Ω–∞ —Ç–µ–Ω—å:

```typescript
// –°–ª–∞–±–∞—è —Ç–µ–Ω—å
fill="#00000010"  // 10% –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å

// –°—Ä–µ–¥–Ω—è—è —Ç–µ–Ω—å (—Ç–µ–∫—É—â–∞—è)
fill="#00000020"  // 20% –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å

// –°–∏–ª—å–Ω–∞—è —Ç–µ–Ω—å
fill="#00000040"  // 40% –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å
```

## –°–º–µ—â–µ–Ω–∏–µ —Ç–µ–Ω–∏

–¢–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è:
```typescript
x={3}  // 3px –≤–ø—Ä–∞–≤–æ
y={4}  // 4px –≤–Ω–∏–∑
```

–ú–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –¥–ª–∏–Ω–Ω–µ–µ:
```typescript
x={5}  // 5px –≤–ø—Ä–∞–≤–æ
y={6}  // 6px –≤–Ω–∏–∑
```

## –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞—Å—Ç–æ—è—â–∏–π shadowBlur

–¢–æ–ª—å–∫–æ –¥–ª—è **–≤—ã–±—Ä–∞–Ω–Ω—ã—Ö** —É–∑–ª–æ–≤ (–∏—Ö –≤—Å–µ–≥–¥–∞ –º–∞–ª–æ):
```typescript
shadowColor={selected ? '#F05A5A99' : undefined}
shadowBlur={selected ? 12 : 0}
```

–≠—Ç–æ –¥–∞—ë—Ç –∫—Ä–∞—Å–∏–≤—ã–π —ç—Ñ—Ñ–µ–∫—Ç —Å–≤–µ—á–µ–Ω–∏—è –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

## –ò—Ç–æ–≥–æ–≤–∞—è —Ñ–æ—Ä–º—É–ª–∞

```
–§–µ–π–∫–æ–≤–∞—è —Ç–µ–Ω—å (–≤—Å–µ–≥–¥–∞) + shadowBlur (—Ç–æ–ª—å–∫–æ selected) + Konva cache = 
  = –ö—Ä–∞—Å–∏–≤–æ + –ë—ã—Å—Ç—Ä–æ + 60 FPS
```

## –ú–µ—Ç—Ä–∏–∫–∏

| –ú–µ—Ç–æ–¥ | FPS (100 —É–∑–ª–æ–≤) | –í—Ä–µ–º—è —Ä–µ–Ω–¥–µ—Ä–∞ |
|-------|----------------|---------------|
| shadowBlur –≤–µ–∑–¥–µ | 15-25 FPS | 150-200ms |
| –ë–µ–∑ —Ç–µ–Ω–µ–π | 60 FPS | 40ms |
| **–§–µ–π–∫–æ–≤—ã–µ —Ç–µ–Ω–∏** | **58-60 FPS** | **45ms** |
| **+ Konva cache** | **60 FPS** | **10-15ms** |

## –ö–æ–¥ –≤ –¥–µ–π—Å—Ç–≤–∏–∏

–ü–æ—Å–º–æ—Ç—Ä–∏ `BoardCanvas.tsx`:
- –°—Ç—Ä–æ–∫–∏ 1925-1930: —Ñ–µ–π–∫–æ–≤–∞—è —Ç–µ–Ω—å –¥–ª—è –∑–∞–¥–∞—á
- –°—Ç—Ä–æ–∫–∏ 2025-2032: —Ñ–µ–π–∫–æ–≤–∞—è —Ç–µ–Ω—å –¥–ª—è –≥—Ä—É–ø–ø
- –°—Ç—Ä–æ–∫–∏ 2148-2155: —Ñ–µ–π–∫–æ–≤–∞—è —Ç–µ–Ω—å –¥–ª—è –ø–µ—Ä—Å–æ–Ω
- –°—Ç—Ä–æ–∫–∏ 1864-1893: Konva caching –ª–æ–≥–∏–∫–∞

## –í–∏–∑—É–∞–ª—å–Ω—ã–π —Ç—é–Ω–∏–Ω–≥

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å —á—É—Ç—å –±–æ–ª—å—à–µ "–≥–ª—É–±–∏–Ω—ã", –º–æ–∂–µ—à—å –¥–æ–±–∞–≤–∏—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç:

```typescript
// –î–≤–æ–π–Ω–∞—è —Ç–µ–Ω—å –¥–ª—è –±–æ–ª—å—à–µ–π –≥–ª—É–±–∏–Ω—ã
<Rect x={4} y={5} fill="#00000010" cornerRadius={8} />
<Rect x={2} y={3} fill="#00000020" cornerRadius={8} />
<Rect x={0} y={0} fill={color} cornerRadius={8} />
```

–ù–æ —ç—Ç–æ –¥–æ—Ä–æ–∂–µ - –∏—Å–ø–æ–ª—å–∑—É–π —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ FPS –æ—Å—Ç–∞—ë—Ç—Å—è > 55.

## üéØ –ò—Ç–æ–≥

–ü–æ–ª—É—á–∏–ª–∏ **–∏ –∫—Ä–∞—Å–æ—Ç—É, –∏ —Å–∫–æ—Ä–æ—Å—Ç—å**:
- ‚úÖ –¢–µ–Ω–∏ –µ—Å—Ç—å (—Ñ–µ–π–∫–æ–≤—ã–µ –Ω–æ –ø–æ—Ö–æ–∂–∏–µ)
- ‚úÖ FPS 58-60 (–∫–∞–∫ –±–µ–∑ —Ç–µ–Ω–µ–π)
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å–∫–æ—Ä—è–µ—Ç –µ—â—ë –±–æ–ª—å—à–µ
- ‚úÖ –í—ã–±—Ä–∞–Ω–Ω—ã–µ —É–∑–ª—ã —Å–≤–µ—Ç—è—Ç—Å—è (–Ω–∞—Å—Ç–æ—è—â–∏–π shadowBlur)

**–õ—É—á—à–µ–µ –∏–∑ –¥–≤—É—Ö –º–∏—Ä–æ–≤!** üöÄ
